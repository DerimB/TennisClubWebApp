{"version":3,"file":"treasurery.min.js","sources":["treasurery.js"],"sourcesContent":["async function fetchMembers(query = \"\") {\r\n    const res = await fetch(`http://localhost:5000/api/members-finances?search=${query}`);\r\n    const members = await res.json();\r\n    console.log(\"Response from /api/members-finances:\", members);\r\n\r\n  \r\n    const container = document.getElementById(\"members-list\");\r\n    container.innerHTML = \"\";\r\n  \r\n    members.forEach(user => {\r\n        const row = document.createElement(\"tr\");\r\n      \r\n        row.innerHTML = `\r\n          <td>${user.id}</td>\r\n          <td>${user.first_name}</td>\r\n          <td>${user.last_name}</td>\r\n          <td>${user.email}</td>\r\n          <td>${user.phone_number}</td>\r\n          <td>${user.balance}</td>\r\n\r\n        `;\r\n      \r\n        container.appendChild(row);\r\n      });\r\n  }\r\n\r\n  document.addEventListener(\"DOMContentLoaded\", () => {\r\n    fetchMembers();\r\n\r\n    document.getElementById(\"search\").addEventListener(\"input\", (e) => {\r\n        fetchMembers(e.target.value);\r\n    });\r\n\r\n    document.querySelector(\".charge-400\").addEventListener(\"click\", async () => {\r\n        const userId = document.getElementById(\"id\").value;\r\n\r\n        const updateData = {\r\n            user_id: parseInt(userId),\r\n            balance: 400\r\n        };\r\n\r\n        try {\r\n            const response = await fetch(\"http://localhost:5000/api/modify-balance\", {\r\n                method: \"PUT\",\r\n                headers: {\r\n                    \"Content-Type\": \"application/json\"\r\n                },\r\n                body: JSON.stringify(updateData)\r\n            });\r\n\r\n            const result = await response.json();\r\n            if (response.ok) {\r\n                alert(\"User balance successfully updated!\");\r\n                fetchMembers();  // refresh the table to show the new balance\r\n                updateUserInfoDisplay();\r\n            } else {\r\n                alert(\"Failed to update user balance: \" + result.error);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error: \", error);\r\n            alert(\"An error occurred while updating the user balance.\");\r\n        }\r\n    });\r\n\r\n    document.querySelector(\".charge-1000\").addEventListener(\"click\", async () => {\r\n      const userId = document.getElementById(\"id\").value;\r\n  \r\n      const updateData = {\r\n          user_id: parseInt(userId),\r\n          balance: 1000\r\n      };\r\n  \r\n      try {\r\n          const response = await fetch(\"http://localhost:5000/api/modify-balance\", {\r\n              method: \"PUT\",\r\n              headers: {\r\n                  \"Content-Type\": \"application/json\"\r\n              },\r\n              body: JSON.stringify(updateData)\r\n          });\r\n  \r\n          const result = await response.json();\r\n          if (response.ok) {\r\n              alert(\"User charged $1000\");\r\n              fetchMembers();  // refresh the table to show the new balance\r\n              updateUserInfoDisplay();\r\n          } else {\r\n              alert(\"Failed to charge user: \" + result.error);\r\n          }\r\n      } catch (error) {\r\n          console.error(\"Error: \", error);\r\n          alert(\"An error occurred while charging the user.\");\r\n      }\r\n  });\r\n\r\n  document.querySelector(\".charge-10p\").addEventListener(\"click\", async () => {\r\n    const userId = parseInt(document.getElementById(\"id\").value);\r\n\r\n    try {\r\n        const res = await fetch(\"http://localhost:5000/api/members-finances\");\r\n        const members = await res.json();\r\n        const user = members.find(m => m.id === userId);\r\n\r\n        if (!user) {\r\n            alert(\"User not found.\");\r\n            return;\r\n        }\r\n\r\n        const tenPercent = Math.round(user.balance * 0.10 * 100) / 100;\r\n\r\n        const updateData = {\r\n            user_id: userId,\r\n            balance: tenPercent\r\n        };\r\n\r\n        const response = await fetch(\"http://localhost:5000/api/modify-balance\", {\r\n            method: \"PUT\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify(updateData)\r\n        });\r\n\r\n        const result = await response.json();\r\n        if (response.ok) {\r\n            alert(`Added 10% fee ($${tenPercent})`);\r\n            fetchMembers();  // refresh the table to show the new balance\r\n            updateUserInfoDisplay();\r\n        } else {\r\n            alert(\"Failed to apply 10% fee: \" + result.error);\r\n        }\r\n    } catch (error) {\r\n        console.error(\"Error: \", error);\r\n        alert(\"An error occurred while applying the fee.\");\r\n    }\r\n});\r\n\r\ndocument.querySelector(\".pay-custom\").addEventListener(\"click\", async () => {\r\n    const userId = document.getElementById(\"id\").value;\r\n    const payment = parseFloat(document.getElementById(\"payment-amount\").value);\r\n\r\n    if (!userId || isNaN(payment)) {\r\n        alert(\"Enter a valid user ID and payment amount.\");\r\n        return;\r\n    }\r\n\r\n    const updateData = {\r\n        user_id: parseInt(userId),\r\n        balance: -payment  // Add negative number to balance (to subtract instead of changing the current modify-balance function)\r\n    };\r\n\r\n    try {\r\n        const response = await fetch(\"http://localhost:5000/api/modify-balance\", {\r\n            method: \"PUT\",\r\n            headers: { \"Content-Type\": \"application/json\" },\r\n            body: JSON.stringify(updateData)\r\n        });\r\n\r\n        const result = await response.json();\r\n        if (response.ok) {\r\n            alert(\"Payment applied successfully.\");\r\n            fetchMembers();  // refresh the table to show the new balance\r\n            updateUserInfoDisplay();\r\n        } else {\r\n            alert(\"Failed to apply payment: \" + result.error);\r\n        }\r\n    } catch (error) {\r\n        console.error(\"Error:\", error);\r\n        alert(\"Error while applying payment.\");\r\n    }\r\n});\r\n\r\n\r\ndocument.querySelector(\".pay-full\").addEventListener(\"click\", async () => {\r\n    const userId = document.getElementById(\"id\").value;\r\n\r\n    if (!userId) {\r\n        alert(\"Enter a valid user ID.\");\r\n        return;\r\n    }\r\n\r\n    const updateData = {\r\n        user_id: parseInt(userId),\r\n        balance: \"PAID_FULL\"\r\n    };\r\n\r\n    try {\r\n        const response = await fetch(\"http://localhost:5000/api/modify-balance\", {\r\n            method: \"PUT\",\r\n            headers: { \"Content-Type\": \"application/json\" },\r\n            body: JSON.stringify(updateData)\r\n        });\r\n\r\n        const result = await response.json();\r\n        if (response.ok) {\r\n            alert(\"Balance set to $0.\");\r\n            fetchMembers();  // refresh the table to show the new balance\r\n            updateUserInfoDisplay();\r\n        } else {\r\n            alert(\"Failed to update balance: \" + result.error);\r\n        }\r\n    } catch (error) {\r\n        console.error(\"Error:\", error);\r\n        alert(\"Error while updating balance.\");\r\n    }\r\n});\r\n\r\n\r\ndocument.getElementById(\"id\").addEventListener(\"input\", updateUserInfoDisplay);\r\n\r\nasync function updateUserInfoDisplay() {\r\n    const userId = parseInt(document.getElementById(\"id\").value);\r\n    if (isNaN(userId)) return;\r\n\r\n    try {\r\n        const res = await fetch(\"http://localhost:5000/api/members-finances\");\r\n        const members = await res.json();\r\n        const user = members.find(m => m.id === userId);\r\n\r\n        if (!user) {\r\n            document.querySelector(\".member-name\").textContent = \"User not found\";\r\n            document.querySelector(\".member-amount-due\").textContent = \"\";\r\n            return;\r\n        }\r\n\r\n        document.querySelector(\".member-name\").textContent = `${user.first_name} ${user.last_name}`;\r\n        document.querySelector(\".member-amount-due\").textContent = `$${user.balance.toFixed(2)}`;\r\n    } catch (err) {\r\n        console.error(\"Error fetching user info:\", err);\r\n    }\r\n}\r\n\r\n});\r\n\r\n  "],"names":["async","fetchMembers","query","members","await","fetch","json","console","log","container","document","getElementById","innerHTML","forEach","user","row","createElement","id","first_name","last_name","email","phone_number","balance","appendChild","addEventListener","updateUserInfoDisplay","userId","parseInt","value","isNaN","find","m","querySelector","textContent","toFixed","err","error","e","target","updateData","user_id","response","method","headers","Content-Type","body","JSON","stringify","result","ok","alert","tenPercent","Math","round","payment","parseFloat"],"mappings":"AAAAA,eAAeC,aAAaC,EAAQ,IAE1BC,EAAUC,MADJA,MAAMC,MAAM,qDAAqDH,CAAO,GAC1DI,KAAK,EAC/BC,QAAQC,IAAI,uCAAwCL,CAAO,EAG3D,IAAMM,EAAYC,SAASC,eAAe,cAAc,EACxDF,EAAUG,UAAY,GAEtBT,EAAQU,QAAQC,IACZ,IAAMC,EAAML,SAASM,cAAc,IAAI,EAEvCD,EAAIH;gBACIE,EAAKG;gBACLH,EAAKI;gBACLJ,EAAKK;gBACLL,EAAKM;gBACLN,EAAKO;gBACLP,EAAKQ;;UAIbb,EAAUc,YAAYR,CAAG,CAC3B,CAAC,CACL,CAEAL,SAASc,iBAAiB,mBAAoB,KAwLhDxB,eAAeyB,IACX,IAAMC,EAASC,SAASjB,SAASC,eAAe,IAAI,EAAEiB,KAAK,EAC3D,GAAIC,CAAAA,MAAMH,CAAM,EAEhB,IACI,IAEMZ,GADUV,MADJA,MAAMC,MAAM,4CAA4C,GAC1CC,KAAK,GACVwB,KAAKC,GAAKA,EAAEd,KAAOS,CAAM,EAEzCZ,GAMLJ,SAASsB,cAAc,cAAc,EAAEC,YAAiBnB,EAAKI,WAAR,IAAsBJ,EAAKK,UAChFT,SAASsB,cAAc,oBAAoB,EAAEC,YAAc,IAAInB,EAAKQ,QAAQY,QAAQ,CAAC,IANjFxB,SAASsB,cAAc,cAAc,EAAEC,YAAc,iBACrDvB,SAASsB,cAAc,oBAAoB,EAAEC,YAAc,GAQnE,CAFE,MAAOE,GACL5B,QAAQ6B,MAAM,4BAA6BD,CAAG,CAClD,CACJ,CA3MIlC,aAAa,EAEbS,SAASC,eAAe,QAAQ,EAAEa,iBAAiB,QAAS,IACxDvB,aAAaoC,EAAEC,OAAOV,KAAK,CAC/B,CAAC,EAEDlB,SAASsB,cAAc,aAAa,EAAER,iBAAiB,QAASxB,UAC5D,IAAM0B,EAAShB,SAASC,eAAe,IAAI,EAAEiB,MAEvCW,EAAa,CACfC,QAASb,SAASD,CAAM,EACxBJ,QAAS,GACb,EAEA,IACI,IAAMmB,EAAWrC,MAAMC,MAAM,2CAA4C,CACrEqC,OAAQ,MACRC,QAAS,CACLC,eAAgB,kBACpB,EACAC,KAAMC,KAAKC,UAAUR,CAAU,CACnC,CAAC,EAEKS,EAAS5C,MAAMqC,EAASnC,KAAK,EAC/BmC,EAASQ,IACTC,MAAM,oCAAoC,EAC1CjD,aAAa,EACbwB,EAAsB,GAEtByB,MAAM,kCAAoCF,EAAOZ,KAAK,CAK9D,CAHE,MAAOA,GACL7B,QAAQ6B,MAAM,UAAWA,CAAK,EAC9Bc,MAAM,oDAAoD,CAC9D,CACJ,CAAC,EAEDxC,SAASsB,cAAc,cAAc,EAAER,iBAAiB,QAASxB,UAC/D,IAAM0B,EAAShB,SAASC,eAAe,IAAI,EAAEiB,MAEvCW,EAAa,CACfC,QAASb,SAASD,CAAM,EACxBJ,QAAS,GACb,EAEA,IACI,IAAMmB,EAAWrC,MAAMC,MAAM,2CAA4C,CACrEqC,OAAQ,MACRC,QAAS,CACLC,eAAgB,kBACpB,EACAC,KAAMC,KAAKC,UAAUR,CAAU,CACnC,CAAC,EAEKS,EAAS5C,MAAMqC,EAASnC,KAAK,EAC/BmC,EAASQ,IACTC,MAAM,oBAAoB,EAC1BjD,aAAa,EACbwB,EAAsB,GAEtByB,MAAM,0BAA4BF,EAAOZ,KAAK,CAKtD,CAHE,MAAOA,GACL7B,QAAQ6B,MAAM,UAAWA,CAAK,EAC9Bc,MAAM,4CAA4C,CACtD,CACJ,CAAC,EAEDxC,SAASsB,cAAc,aAAa,EAAER,iBAAiB,QAASxB,UAC9D,IAAM0B,EAASC,SAASjB,SAASC,eAAe,IAAI,EAAEiB,KAAK,EAE3D,IACI,IASMuB,EAEAZ,EAKAE,EAQAO,EAtBAlC,GADUV,MADJA,MAAMC,MAAM,4CAA4C,GAC1CC,KAAK,GACVwB,KAAKC,GAAKA,EAAEd,KAAOS,CAAM,EAEzCZ,GAKCqC,EAAaC,KAAKC,MAAqB,GAAfvC,EAAKQ,QAAiB,GAAG,EAAI,IAErDiB,EAAa,CACfC,QAASd,EACTJ,QAAS6B,CACb,EAUMH,EAAS5C,MARTqC,EAAWrC,MAAMC,MAAM,2CAA4C,CACrEqC,OAAQ,MACRC,QAAS,CACLC,eAAgB,kBACpB,EACAC,KAAMC,KAAKC,UAAUR,CAAU,CACnC,CAAC,GAE6BjC,KAAK,EAC/BmC,EAASQ,IACTC,yBAAyBC,IAAa,EACtClD,aAAa,EACbwB,EAAsB,GAEtByB,MAAM,4BAA8BF,EAAOZ,KAAK,GAzBhDc,MAAM,iBAAiB,CA8B/B,CAHE,MAAOd,GACL7B,QAAQ6B,MAAM,UAAWA,CAAK,EAC9Bc,MAAM,2CAA2C,CACrD,CACJ,CAAC,EAEDxC,SAASsB,cAAc,aAAa,EAAER,iBAAiB,QAASxB,UAC5D,IAAM0B,EAAShB,SAASC,eAAe,IAAI,EAAEiB,MACvC0B,EAAUC,WAAW7C,SAASC,eAAe,gBAAgB,EAAEiB,KAAK,EAE1E,GAAI,CAACF,GAAUG,MAAMyB,CAAO,EACxBJ,MAAM,2CAA2C,MADrD,CAKMX,EAAa,CACfC,QAASb,SAASD,CAAM,EACxBJ,QAAS,CAACgC,CACd,EAEA,IACI,IAAMb,EAAWrC,MAAMC,MAAM,2CAA4C,CACrEqC,OAAQ,MACRC,QAAS,CAAEC,eAAgB,kBAAmB,EAC9CC,KAAMC,KAAKC,UAAUR,CAAU,CACnC,CAAC,EAEKS,EAAS5C,MAAMqC,EAASnC,KAAK,EAC/BmC,EAASQ,IACTC,MAAM,+BAA+B,EACrCjD,aAAa,EACbwB,EAAsB,GAEtByB,MAAM,4BAA8BF,EAAOZ,KAAK,CAKxD,CAHE,MAAOA,GACL7B,QAAQ6B,MAAM,SAAUA,CAAK,EAC7Bc,MAAM,+BAA+B,CACzC,CAzBA,CA0BJ,CAAC,EAGDxC,SAASsB,cAAc,WAAW,EAAER,iBAAiB,QAASxB,UAC1D,IAAM0B,EAAShB,SAASC,eAAe,IAAI,EAAEiB,MAE7C,GAAKF,EAAL,CAKMa,EAAa,CACfC,QAASb,SAASD,CAAM,EACxBJ,QAAS,WACb,EAEA,IACI,IAAMmB,EAAWrC,MAAMC,MAAM,2CAA4C,CACrEqC,OAAQ,MACRC,QAAS,CAAEC,eAAgB,kBAAmB,EAC9CC,KAAMC,KAAKC,UAAUR,CAAU,CACnC,CAAC,EAEKS,EAAS5C,MAAMqC,EAASnC,KAAK,EAC/BmC,EAASQ,IACTC,MAAM,oBAAoB,EAC1BjD,aAAa,EACbwB,EAAsB,GAEtByB,MAAM,6BAA+BF,EAAOZ,KAAK,CAKzD,CAHE,MAAOA,GACL7B,QAAQ6B,MAAM,SAAUA,CAAK,EAC7Bc,MAAM,+BAA+B,CACzC,CAzBA,MAFIA,MAAM,wBAAwB,CA4BtC,CAAC,EAGDxC,SAASC,eAAe,IAAI,EAAEa,iBAAiB,QAASC,CAAqB,CAwB7E,CAAC"}